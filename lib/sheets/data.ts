import type {
  Property,
  DashboardMetrics,
  RevenueProjection,
  PLStatement,
  UnitEconomics,
  InvestmentReturns,
  UseOfFunds,
  RevenueChartData,
} from '@/types/financial'

// Pre-fetched data from Google Sheets
// In production, this would be fetched via API routes or server components

export const PROPERTIES: Property[] = [
  {
    id: 'hotel-alea-tulum',
    name: 'Hotel Alea Tulum',
    location: 'Bahia de Soliman, Tulum, Q.R.',
    propertyType: 'Operating 4-star boutique hotel',
    currentUse: 'Hotel operations',
    score: 75,
    targetMarket: 'HNW Individuals',
    status: 'SHORTLIST',
    capacity: {
      totalRooms: 21,
      treatmentBeds: { conservative: 15, base: 17, aggressive: 19 },
      maxGuestsPerYear: 310,
    },
    acquisition: {
      askingPrice: 6400000,
      negotiatedPrice: 6400000,
      closingCosts: 320000,
      totalAcquisitionCost: 6720000,
    },
    imageUrl: '/images/properties/hotel-alea-tulum.jpg',
  },
  {
    id: 'hacienda-caracol',
    name: 'Hacienda Caracol',
    location: 'Soliman Bay, Tulum, Q.R.',
    propertyType: 'Luxury vacation rental',
    currentUse: 'Vacation rental ($2,425/night)',
    score: 76,
    targetMarket: 'U-HNW Individuals',
    status: 'SHORTLIST',
    capacity: {
      totalRooms: 10,
      treatmentBeds: { conservative: 7, base: 8, aggressive: 9 },
      maxGuestsPerYear: 146,
    },
    acquisition: {
      askingPrice: 4900000,
      negotiatedPrice: 4900000,
      closingCosts: 245000,
      totalAcquisitionCost: 5145000,
    },
    imageUrl: '/images/properties/hacienda-caracol.jpg',
  },
  {
    id: 'mini-hotel-cancun',
    name: 'Mini Hotel Cancun',
    location: 'Cancun, Q.R.',
    propertyType: 'Operating mini hotel',
    currentUse: 'Mini hotel operations',
    score: 79,
    targetMarket: 'HNW Individuals',
    status: 'SHORTLIST',
    capacity: {
      totalRooms: 20,
      treatmentBeds: { conservative: 14, base: 16, aggressive: 18 },
      maxGuestsPerYear: 292,
    },
    acquisition: {
      askingPrice: 1100000,
      negotiatedPrice: 1100000,
      closingCosts: 55000,
      totalAcquisitionCost: 1155000,
    },
    imageUrl: '/images/properties/mini-hotel-cancun.jpg',
  },
  {
    id: 'casa-sueno-de-mar',
    name: 'Casa Sueno de Mar',
    location: 'Tulum Country Club, Akumal, Q.R.',
    propertyType: 'Residential (gated community)',
    currentUse: 'Residential',
    score: 66,
    targetMarket: 'HNW Individuals',
    status: 'HOLD',
    capacity: {
      totalRooms: 7,
      treatmentBeds: { conservative: 5, base: 6, aggressive: 7 },
      maxGuestsPerYear: 110,
    },
    acquisition: {
      askingPrice: 4000000,
      negotiatedPrice: 4000000,
      closingCosts: 200000,
      totalAcquisitionCost: 4200000,
    },
    imageUrl: '/images/properties/casa-sueno-de-mar.jpg',
  },
]

export const DASHBOARD_METRICS: DashboardMetrics = {
  propertyName: 'Hotel Alea Tulum',
  location: 'Bahia de Soliman, Tulum, Q.R.',
  totalRooms: 21,
  treatmentBeds: 17,
  propertyScore: 75,
  recommendation: 'PROCEED (conditional)',
  averageDailyRate: 2321,
  keyMetrics: {
    acquisitionPrice: 6400000,
    totalProjectCost: 19036750,
    costPerRoom: 906512,
    revenue: {
      year1: { conservative: 5784167, base: 7614215, aggressive: 9497964 },
      year3: { conservative: 11160888, base: 13434319, aggressive: 14665114 },
      year5: { conservative: 12964175, base: 15303003, aggressive: 16156481 },
      fiveYearTotal: { conservative: 51158779, base: 62109066, aggressive: 68804678 },
    },
    projectIRR: { conservative: 0.23, base: 0.30, aggressive: 0.36 },
    fiveYearMOIC: { conservative: 2.5, base: 3.0, aggressive: 3.5 },
  },
}

export const REVENUE_PROJECTIONS: RevenueProjection[] = [
  {
    year: 1,
    programRevenue: { conservative: 4978255, base: 6549862, aggressive: 8168827 },
    bioOptimizationPremium: { conservative: 559753, base: 736859, aggressive: 919965 },
    wellnessProducts: { conservative: 99558, base: 130997, aggressive: 163436 },
    postCareSubscriptions: { conservative: 0, base: 0, aggressive: 0 },
    conciergeServices: { conservative: 149337, base: 196496, aggressive: 245154 },
    totalRevenue: { conservative: 5784167, base: 7614215, aggressive: 9497964 },
  },
  {
    year: 2,
    programRevenue: { conservative: 6657305, base: 8759454, aggressive: 10924442 },
    bioOptimizationPremium: { conservative: 998578, base: 1313918, aggressive: 1639258 },
    wellnessProducts: { conservative: 266287, base: 350378, aggressive: 437022 },
    postCareSubscriptions: { conservative: 399431, base: 525567, aggressive: 655702 },
    conciergeServices: { conservative: 199716, base: 262784, aggressive: 327780 },
    totalRevenue: { conservative: 8521317, base: 11212101, aggressive: 13984204 },
  },
  {
    year: 3,
    programRevenue: { conservative: 7976607, base: 10495562, aggressive: 13093702 },
    bioOptimizationPremium: { conservative: 1196494, base: 1574334, aggressive: 1964158 },
    wellnessProducts: { conservative: 319065, base: 419822, aggressive: 523723 },
    postCareSubscriptions: { conservative: 478598, base: 629734, aggressive: 785660 },
    conciergeServices: { conservative: 239299, base: 314867, aggressive: 392832 },
    totalRevenue: { conservative: 11160888, base: 13434319, aggressive: 14665114 },
  },
  {
    year: 4,
    programRevenue: { conservative: 8636309, base: 11363616, aggressive: 14176429 },
    bioOptimizationPremium: { conservative: 1295452, base: 1704542, aggressive: 2126068 },
    wellnessProducts: { conservative: 345454, base: 454545, aggressive: 567079 },
    postCareSubscriptions: { conservative: 518181, base: 681817, aggressive: 850618 },
    conciergeServices: { conservative: 259090, base: 340908, aggressive: 425353 },
    totalRevenue: { conservative: 12054486, base: 14545428, aggressive: 15979946 },
  },
  {
    year: 5,
    programRevenue: { conservative: 9086158, base: 11955471, aggressive: 14914463 },
    bioOptimizationPremium: { conservative: 1362924, base: 1793321, aggressive: 2237142 },
    wellnessProducts: { conservative: 363447, base: 478219, aggressive: 596613 },
    postCareSubscriptions: { conservative: 545169, base: 717328, aggressive: 894919 },
    conciergeServices: { conservative: 272585, base: 358664, aggressive: 447500 },
    totalRevenue: { conservative: 12964175, base: 15303003, aggressive: 16156481 },
  },
]

export const REVENUE_CHART_DATA: RevenueChartData[] = [
  { year: 'Year 1', conservative: 5784167, base: 7614215, aggressive: 9497964 },
  { year: 'Year 2', conservative: 8521317, base: 11212101, aggressive: 13984204 },
  { year: 'Year 3', conservative: 11160888, base: 13434319, aggressive: 14665114 },
  { year: 'Year 4', conservative: 12054486, base: 14545428, aggressive: 15979946 },
  { year: 'Year 5', conservative: 12964175, base: 15303003, aggressive: 16156481 },
]

export const PL_STATEMENTS: PLStatement[] = [
  {
    year: 1,
    revenue: {
      programRevenue: 6549862,
      bioOptimizationPremium: 736859,
      wellnessProducts: 130997,
      postCareSubscriptions: 0,
      conciergeServices: 196496,
      total: 7614215,
    },
    cogs: 2091600,
    grossProfit: 5522615,
    grossMarginPercent: 0.73,
    operatingExpenses: {
      facilityCosts: 576000,
      personnel: 2010000,
      professionalServices: 228000,
      technology: 144000,
      marketing: 660000,
      gAndA: 504000,
      total: 4122000,
    },
    totalOpex: 4122000,
    ebitda: 1400615,
    ebitdaMarginPercent: 0.18,
    depreciation: 902238,
    ebit: 498377,
    interestExpense: 0,
    ebt: 498377,
    taxes: 149513,
    netIncome: 348864,
  },
  {
    year: 2,
    revenue: {
      programRevenue: 8759454,
      bioOptimizationPremium: 1313918,
      wellnessProducts: 350378,
      postCareSubscriptions: 525567,
      conciergeServices: 262784,
      total: 11212101,
    },
    cogs: 2909088,
    grossProfit: 8303013,
    grossMarginPercent: 0.74,
    operatingExpenses: {
      facilityCosts: 599040,
      personnel: 2090400,
      professionalServices: 237120,
      technology: 149760,
      marketing: 686400,
      gAndA: 524160,
      total: 4286880,
    },
    totalOpex: 4286880,
    ebitda: 4016133,
    ebitdaMarginPercent: 0.36,
    depreciation: 902238,
    ebit: 3113895,
    interestExpense: 0,
    ebt: 3113895,
    taxes: 934168,
    netIncome: 2179727,
  },
  {
    year: 3,
    revenue: {
      programRevenue: 10495562,
      bioOptimizationPremium: 1574334,
      wellnessProducts: 419822,
      postCareSubscriptions: 629734,
      conciergeServices: 314867,
      total: 13434319,
    },
    cogs: 3625091,
    grossProfit: 9809229,
    grossMarginPercent: 0.73,
    operatingExpenses: {
      facilityCosts: 623002,
      personnel: 2174016,
      professionalServices: 246605,
      technology: 155750,
      marketing: 713856,
      gAndA: 545126,
      total: 4458355,
    },
    totalOpex: 4458355,
    ebitda: 5350874,
    ebitdaMarginPercent: 0.40,
    depreciation: 902238,
    ebit: 4448636,
    interestExpense: 0,
    ebt: 4448636,
    taxes: 1334591,
    netIncome: 3114045,
  },
  {
    year: 4,
    revenue: {
      programRevenue: 11363616,
      bioOptimizationPremium: 1704542,
      wellnessProducts: 454545,
      postCareSubscriptions: 681817,
      conciergeServices: 340908,
      total: 14545428,
    },
    cogs: 4081906,
    grossProfit: 10463522,
    grossMarginPercent: 0.72,
    operatingExpenses: {
      facilityCosts: 647922,
      personnel: 2260977,
      professionalServices: 256469,
      technology: 161980,
      marketing: 742410,
      gAndA: 566931,
      total: 4636689,
    },
    totalOpex: 4636689,
    ebitda: 5826833,
    ebitdaMarginPercent: 0.40,
    depreciation: 902238,
    ebit: 4924595,
    interestExpense: 0,
    ebt: 4924595,
    taxes: 1477379,
    netIncome: 3447216,
  },
  {
    year: 5,
    revenue: {
      programRevenue: 11955471,
      bioOptimizationPremium: 1793321,
      wellnessProducts: 478219,
      postCareSubscriptions: 717328,
      conciergeServices: 358664,
      total: 15303003,
    },
    cogs: 4466286,
    grossProfit: 10836717,
    grossMarginPercent: 0.71,
    operatingExpenses: {
      facilityCosts: 673839,
      personnel: 2351416,
      professionalServices: 266728,
      technology: 168460,
      marketing: 772107,
      gAndA: 589609,
      total: 4822157,
    },
    totalOpex: 4822157,
    ebitda: 6014560,
    ebitdaMarginPercent: 0.39,
    depreciation: 902238,
    ebit: 5112322,
    interestExpense: 0,
    ebt: 5112322,
    taxes: 1533697,
    netIncome: 3578625,
  },
]

export const UNIT_ECONOMICS: UnitEconomics = {
  revenuePerGuest: [
    { name: 'Base Program Fee (Avg)', amount: 39457, percentOfRevenue: 100, notes: 'Weighted average program' },
    { name: 'Bio-optimization Add-ons', amount: 5919, percentOfRevenue: 15, notes: 'Stem cells, NAD+, PRP' },
    { name: 'Wellness Products', amount: 1578, percentOfRevenue: 4, notes: 'Supplements, protocols' },
    { name: 'Concierge Services', amount: 1184, percentOfRevenue: 3, notes: 'Travel, experiences' },
  ],
  totalGuestRevenue: 48138,
  directCostsPerGuest: [
    { name: 'Medical Staff & Oversight', amount: 4200, percentOfRevenue: 11, notes: '24/7 physician coverage' },
    { name: 'Facilitators & Therapy', amount: 3000, percentOfRevenue: 8, notes: 'Ceremony, integration' },
    { name: 'Food & Hospitality', amount: 2800, percentOfRevenue: 7, notes: 'Premium organic meals' },
    { name: 'Bio-optimization Supplies', amount: 1200, percentOfRevenue: 3, notes: 'IV supplies, biologics' },
    { name: 'Plant Medicine Materials', amount: 600, percentOfRevenue: 2, notes: 'Ibogaine, psilocybin' },
    { name: 'Guest Amenities', amount: 500, percentOfRevenue: 1, notes: 'Welcome kit, excursions' },
    { name: 'Medical Evacuation Reserve', amount: 300, percentOfRevenue: 1, notes: 'Emergency fund per guest' },
  ],
  totalDirectCosts: 12600,
  grossProfitPerGuest: 35538,
  contributionMargin: 0.74,
  blendedCAC: 2613,
  ltv: 48138,
  ltvCacRatio: 18.4,
}

export const INVESTMENT_RETURNS: InvestmentReturns = {
  totalCapitalRequired: 19036750,
  equityInvestment: 19036750,
  debtFinancing: 0,
  yearlyReturns: [
    {
      year: 1,
      totalInvestment: 19036750,
      annualNetIncome: 348864,
      cumulativeNetIncome: 348864,
      roiCumulative: 0.02,
      roiAnnualized: 0.02,
    },
    {
      year: 2,
      totalInvestment: 19036750,
      annualNetIncome: 2179727,
      cumulativeNetIncome: 2528591,
      roiCumulative: 0.13,
      roiAnnualized: 0.07,
    },
    {
      year: 3,
      totalInvestment: 19036750,
      annualNetIncome: 3114045,
      cumulativeNetIncome: 5642636,
      roiCumulative: 0.30,
      roiAnnualized: 0.10,
    },
    {
      year: 4,
      totalInvestment: 19036750,
      annualNetIncome: 3447216,
      cumulativeNetIncome: 9089852,
      roiCumulative: 0.48,
      roiAnnualized: 0.12,
    },
    {
      year: 5,
      totalInvestment: 19036750,
      annualNetIncome: 3578625,
      cumulativeNetIncome: 12668477,
      roiCumulative: 0.67,
      roiAnnualized: 0.13,
    },
  ],
  npv: {
    rate10: -8096607,
    rate12: -8716173,
    rate15: -9552901,
  },
  irr: { conservative: 0.23, base: 0.30, aggressive: 0.36 },
  moic: { conservative: 2.5, base: 3.0, aggressive: 3.5 },
}

export const USE_OF_FUNDS: UseOfFunds[] = [
  { category: 'Property Acquisition', amount: 6720000, percentage: 35.3, description: 'Purchase price + closing costs' },
  { category: 'Renovation & Build-out', amount: 5350000, percentage: 28.1, description: 'Medical-grade improvements' },
  { category: 'Medical Equipment', amount: 1600000, percentage: 8.4, description: 'Treatment rooms, monitoring' },
  { category: 'FF&E', amount: 1300000, percentage: 6.8, description: 'Furniture, fixtures, equipment' },
  { category: 'Technology Systems', amount: 370000, percentage: 1.9, description: 'EMR, security, integration' },
  { category: 'Pre-opening Costs', amount: 565000, percentage: 3.0, description: 'Staffing, training, marketing' },
  { category: 'Working Capital', amount: 2131750, percentage: 11.2, description: '6-month operating reserve' },
  { category: 'Contingency', amount: 1000000, percentage: 5.3, description: 'Project risk buffer' },
]
